@model WebAppWithDb.Models.RequestsInboxVM
@{
    ViewData["Title"] = "Requests Inbox";
}

<div class="rounded-4 shadow-sm p-4 p-md-5 bg-dark text-white">
    <h1 class="fw-bold mb-4">Requests</h1>

    @if (TempData["Toast"] is string t)
    {
        <div class="alert alert-info border-0">@t</div>
    }

    <ul class="nav nav-tabs" role="tablist">
        <li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#pending" type="button">Pending</button></li>
        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#accepted" type="button">Accepted</button></li>
        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#rejected" type="button">Rejected / Removed</button></li>
    </ul>

    <div class="tab-content pt-3">

        <!-- Pending -->
        <div class="tab-pane fade show active" id="pending">
            @if (!Model.Pending.Any())
            {
                <div class="alert bg-secondary text-white border-0">No pending requests.</div>
            }
            else
            {
                <div class="card bg-dark text-white border-secondary">
                    <div class="card-body p-0">
                        <table class="table table-dark table-hover align-middle mb-0">
                            <thead><tr><th>Name</th><th>City</th><th class="text-end">Actions</th></tr></thead>
                            <tbody>
                                @foreach (var r in Model.Pending)
                                {
                                    <tr>
                                        <td>@r.Student?.FullName</td>
                                        <td>@r.Student?.City</td>
                                        <td class="text-end">
                                            <form asp-action="Accept" method="post" class="d-inline">
                                                <input type="hidden" name="id" value="@r.RequestId" />
                                                <button class="btn btn-success btn-sm">Accept</button>
                                            </form>
                                            <form asp-action="Reject" method="post" class="d-inline">
                                                <input type="hidden" name="id" value="@r.RequestId" />
                                                <button class="btn btn-outline-danger btn-sm">Reject</button>
                                            </form>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            }
        </div>

        <!-- Accepted -->
        <div class="tab-pane fade" id="accepted">
            @if (!Model.Accepted.Any())
            {
                <div class="alert bg-secondary text-white border-0">No accepted students.</div>
            }
            else
            {
                <div class="card bg-dark text-white border-secondary">
                    <div class="card-body p-0">
                        <table class="table table-dark table-hover align-middle mb-0">
                            <thead><tr><th>Name</th><th>City</th><th class="text-end">Actions</th></tr></thead>
                            <tbody>
                                @foreach (var r in Model.Accepted)
                                {
                                    <tr>
                                        <td>@r.Student?.FullName</td>
                                        <td>@r.Student?.City</td>
                                        <td class="text-end">
                                            <form asp-action="Remove" method="post" class="d-inline">
                                                <input type="hidden" name="id" value="@r.RequestId" />
                                                <button class="btn btn-warning btn-sm">Remove</button>
                                            </form>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            }
        </div>

        <!-- Rejected -->
        <div class="tab-pane fade" id="rejected">
            @if (!Model.Rejected.Any())
            {
                <div class="alert bg-secondary text-white border-0">Empty.</div>
            }
            else
            {
                <ul class="list-group list-group-flush">
                    @foreach (var r in Model.Rejected)
                    {
                        <li class="list-group-item bg-dark text-white d-flex justify-content-between border-secondary">
                            <span>@r.Student?.FullName</span>
                            <small class="text-white-50">@r.Status</small>
                        </li>
                    }
                </ul>
            }
        </div>
    </div>
</div>
